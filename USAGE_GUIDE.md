# MCP配置管理器插件使用指南

## 🚀 快速开始

### 1. 启动插件

在VS Code扩展开发环境中，插件会自动激活。你可以通过以下方式验证插件是否正常运行：

- 检查状态栏是否显示MCP图标
- 打开命令面板 (`Cmd+Shift+P`) 搜索 "MCP Manager"
- 在文件资源管理器中右键查看是否有MCP相关选项

### 2. 基本使用流程

```
1. 打开包含MCP配置的工作区
2. 插件自动检测 mcp.json 文件
3. 使用命令面板或状态栏打开管理器
4. 在WebView界面中管理MCP服务
```

## 📋 主要功能演示

### 🔍 自动文件检测

插件会自动检测工作区中的MCP配置文件：

```json
// mcp.json - 示例配置文件
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-filesystem", "/path/to/files"],
      "env": {
        "NODE_ENV": "production"
      }
    }
  }
}
```

**检测结果：**
- ✅ 自动发现配置文件
- ✅ 解析服务配置
- ✅ 显示服务数量和状态

### ⚙️ 服务管理

#### 添加新服务
1. 打开MCP管理器
2. 点击 "添加服务" 按钮
3. 填写服务配置：
   - 服务名称
   - 执行命令
   - 命令参数
   - 环境变量
4. 保存配置

#### 编辑现有服务
1. 在服务列表中选择要编辑的服务
2. 点击 "编辑" 按钮
3. 修改配置参数
4. 保存更改

#### 删除服务
1. 选择要删除的服务
2. 点击 "删除" 按钮
3. 确认删除操作

### ✅ 配置验证

插件提供实时配置验证功能：

**验证项目：**
- JSON语法正确性
- 必需字段完整性
- 命令路径有效性
- 参数格式正确性

**验证结果示例：**
```
✅ 配置文件结构正确
🔧 验证服务: filesystem
  ✅ 命令: npx
  ✅ 参数: -y @modelcontextprotocol/server-filesystem /path/to/files
  ✅ 环境变量: 1 个
```

### 🌐 WebView界面

现代化的React界面提供直观的配置管理体验：

**界面组件：**
- 📋 服务列表：显示所有配置的MCP服务
- ✏️ 配置编辑器：可视化编辑服务配置
- ⚙️ 设置面板：插件全局设置
- 📊 状态显示：实时显示服务状态

**用户交互流程：**
```
用户操作 → 界面响应 → 配置更新 → 状态刷新
```

## 🎯 命令面板集成

### 可用命令

| 命令 | 功能 | 快捷键 |
|------|------|--------|
| `MCP Manager: 打开管理器` | 打开主界面 | - |
| `MCP Manager: 添加服务` | 快速添加服务 | - |
| `MCP Manager: 验证配置` | 验证当前配置 | - |
| `MCP Manager: 刷新服务列表` | 重新加载配置 | - |
| `MCP Manager: 导出配置` | 导出配置文件 | - |

### 使用方法

1. 按 `Cmd+Shift+P` 打开命令面板
2. 输入 "MCP" 筛选相关命令
3. 选择要执行的命令
4. 按回车执行

## 🚨 错误处理

### 常见错误类型

#### 1. 配置文件错误
```json
// ❌ 错误示例：缺少逗号
{
  "mcpServers": {
    "filesystem": {
      "command": "npx"
      "args": ["-y", "server"]
    }
  }
}
```

**错误提示：**
```
❌ 配置文件语法错误：第4行缺少逗号
```

**修复方法：**
```json
// ✅ 正确示例
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",  // 添加逗号
      "args": ["-y", "server"]
    }
  }
}
```

#### 2. 命令不存在错误
```
⚠️ 服务启动失败：命令 "invalid-command" 不存在
```

**解决方案：**
- 检查命令是否正确安装
- 验证命令路径
- 使用绝对路径

#### 3. 权限错误
```
❌ 访问被拒绝：无法读取配置文件
```

**解决方案：**
- 检查文件权限
- 确保VS Code有访问权限

## 📊 性能监控

### 插件性能指标

- **启动时间**: < 100ms
- **配置加载**: < 50ms
- **界面响应**: < 200ms
- **内存使用**: < 10MB

### 优化建议

1. **配置文件大小**: 建议 < 1MB
2. **服务数量**: 建议 < 50个
3. **监控频率**: 默认每5秒检查一次

## 🔧 高级配置

### 插件设置

在VS Code设置中可以配置：

```json
{
  "mcp-manager.autoDetect": true,
  "mcp-manager.validateOnSave": true,
  "mcp-manager.showNotifications": true,
  "mcp-manager.refreshInterval": 5000
}
```

### 自定义配置路径

```json
{
  "mcp-manager.configPath": "./custom-mcp.json"
}
```

## 🐛 故障排除

### 常见问题

**Q: 插件无法检测到配置文件**
A: 确保配置文件名为 `mcp.json` 且位于工作区根目录

**Q: WebView界面无法加载**
A: 检查网络连接，重启VS Code

**Q: 命令执行失败**
A: 检查命令权限和路径设置

### 调试模式

1. 打开VS Code开发者工具
2. 查看控制台输出
3. 检查错误日志
4. 使用断点调试

## 📞 支持与反馈

如果遇到问题或有改进建议：

1. 查看控制台错误信息
2. 检查配置文件格式
3. 重启VS Code
4. 提交Issue到GitHub仓库

---

**祝你使用愉快！** 🎉